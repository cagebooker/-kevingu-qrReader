"use strict";var e=require("react"),t=require("react-svg"),a=require("react-qr-scanner"),n=require("use-sound"),r=require("react-bootstrap/Spinner");function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=s(e),l=s(a),o=s(n),c=s(r);const d=e.memo((a=>{const[n,r]=e.useState("normal"),[s,d]=e.useState(""),[u,m]=e.useState(1),[f,g]=e.useState(!1),[p]=o.default(process.env.PUBLIC_URL+"/assets/music/entryScan-success.mp3"),[x]=o.default(process.env.PUBLIC_URL+"/assets/music/entryScan-error.mp3"),h=()=>{const e=new Date;e.setUTCHours(e.getUTCHours()+8);return`${e.getUTCFullYear()}/${(e.getUTCMonth()+1).toString().padStart(2,"0")}/${e.getUTCDate().toString().padStart(2,"0")} ${e.getUTCHours().toString().padStart(2,"0")}:${e.getUTCMinutes().toString().padStart(2,"0")}:${e.getUTCSeconds().toString().padStart(2,"0")}`},y=e.useCallback((async e=>{if(e){if("normal"!==n)return;r("wait");const t={serialNumber:u<10?`0${u}`:u,code:e.text,time:h()};d([t,...s]),m(u>=99?1:u+1),g(!0)}}),[n,s,u,r]),b=e.useCallback((e=>{e&&console.log(e)}),[]);return e.useEffect((()=>{f&&(a.data(s),r("wait"),g(!1))}),[n,f,a,s,g,r]),e.useEffect((()=>{const e=(e,t)=>{r(e),t&&t(),"normal"!==e&&"wait"!==e&&setTimeout((()=>{r("normal"),a.setStatus("normal")}),3e3)};switch(a.status){case"normal":r("normal");break;case"wait":e("wait",null);break;case"success":e("success",p);break;case"warning":e("warning",x);break;default:e("error",x)}}),[a,p,x]),i.default.createElement("div",{className:"d-flex align-items-center justify-content-center flex-column"},i.default.createElement("div",{className:"d-flex align-items-center justify-content-center flex-column",style:{background:"rgba(217, 217, 217, 0)",width:"330px",height:`${a.height}px`,borderRadius:"10px",margin:"0px",position:"relative"}},"normal"===n?i.default.createElement("div",null,i.default.createElement(l.default,{style:{width:`${a.width}px`,height:`${a.height}px`,objectFit:"cover",background:"black",marginTop:"8px"},onError:e=>b(e),onScan:e=>y(e),delay:100,constraints:window.innerWidth>1280?void 0:{video:{facingMode:{exact:"environment"}}}}),"normal"===n&&i.default.createElement("div",{style:{background:"rgba(102, 252, 241, 0.7)",height:"5px",width:`${a.width}px`,borderRadius:"10px",position:"absolute",bottom:"0",animation:"moveUpDown 3s ease-in-out infinite"}})):i.default.createElement("div",{style:{width:`${a.width}px`,height:`${a.height}px`,background:"black"}},"wait"===n&&i.default.createElement("div",{className:"d-flex align-items-center justify-content-center flex-column",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},i.default.createElement("div",{style:{width:`${a.width}px`,height:`${a.height}px`,background:"black",display:"flex",justifyContent:"center",alignItems:"center"}},i.default.createElement(c.default,{animation:"border",variant:"light"}))),"success"===n&&i.default.createElement("div",{className:"d-flex align-items-center justify-content-center flex-column",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},i.default.createElement(t.ReactSVG,{src:process.env.PUBLIC_URL+"/assets/img/scan/entrtScan-pass.svg",style:{width:"100%",opacity:"0.8",display:"flex",justifyContent:"center",marginBottom:"20px"}}),i.default.createElement("div",{className:"d-flex align-items-center justify-content-center",style:{background:"rgba(102, 252, 241, 1)",height:"48px",width:"200px",borderRadius:"5px",color:"black",fontSize:"18px",fontWeight:"400",opacity:"0.8"}},"兌換成功")),"warning"===n&&i.default.createElement("div",{className:"d-flex align-items-center justify-content-center flex-column",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},i.default.createElement(t.ReactSVG,{src:process.env.PUBLIC_URL+"/assets/img/scan/entrtScan-warning.svg",style:{width:"100%",opacity:"0.8",display:"flex",justifyContent:"center",marginBottom:"20px"}}),i.default.createElement("div",{className:"d-flex align-items-center justify-content-center",style:{background:"#FCD266",height:"48px",width:"200px",borderRadius:"5px",color:"black",fontSize:"18px",fontWeight:"400",opacity:"0.8"}},"票券有誤")),"error"===n&&i.default.createElement("div",{className:"d-flex align-items-center justify-content-center flex-column",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},i.default.createElement(t.ReactSVG,{src:process.env.PUBLIC_URL+"/assets/img/scan/entrtScan-error.svg",style:{width:"100%",opacity:"0.8",display:"flex",justifyContent:"center",marginBottom:"20px"}}),i.default.createElement("div",{className:"d-flex align-items-center justify-content-center",style:{background:"rgba(249, 103, 103, 1)",height:"48px",width:"200px",borderRadius:"5px",color:"black",fontSize:"18px",fontWeight:"400",opacity:"0.8"}},"無效票券"))),i.default.createElement("img",{src:process.env.PUBLIC_URL+`/assets/img/scan/entrtScan-frame${"normal"===n?"":"warning"===n?"Yellow":"error"===n?"Red":"Tint"}.svg`,className:"img-fluid",alt:"",style:{width:`${a.width}px`,height:`${a.height}px`,position:"absolute",left:"62px",top:"0px",transform:"scale(1.2,1.12)"}})))}));module.exports=d;
//# sourceMappingURL=index.min.js.map
